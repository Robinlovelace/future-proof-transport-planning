---
title: Data Science for Future-Proof Transport Planning
format: 
  # Install plugin with quarto install extension grantmcdermott/quarto-revealjs-clean
  clean-revealjs:
    self-contained: true
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
author:
  - name: Inaugural Lecture<br>Robin Lovelace
    orcid: 0000-0001-5679-6536
    email: r.lovelace@leeds.ac.uk
    affiliations: University of Leeds
date: 2025-05-08
bibliography: references.bib
execute: 
  cache: true
---

```{r}
#| include: false
#| cache: false
library(tidyverse)
library(sf)
remotes::install_cran("rmapshaper")
library(tmap)
tmap_mode("view")
```

## Contents

Past

-   Before Leeds
-   Leeds

**Present**

-   Transport Data Science
-   Biclar
-   Network Planning Tool

**FUTURE**

::: notes
-   Past: my journey and the people who made it possible
    -   Taking the liberty of talking about my life
-   Present: where I'm at
-   Future: where I'm going
:::

## My journey

```{r}
#| include: false
locations = read_csv("locations.csv")
# locations
# # A tibble: 7 √ó 2
#   address    year
#   <chr>     <dbl>
# 1 Hereford   1985
# 2 Bristol    2004
# 3 Salamanca  2006
# 4 Bristol    2007
# 5 York       2008
# 6 Sheffield  2009
# 7 Leeds      2013
locations_until = locations |>
  mutate(
    until = c(as.character(year[-1]), ""),
    Years = paste0(address, ": ", year, " - ", until)
  )
locations_salamanca = locations_until |>
  filter(address == "Salamanca")
locations_minimal = locations |>
  filter(address != "Salamanca") |>
  filter(year != 2007) |>
  mutate(
    until = c(as.character(year[-1]), ""),
    Years = paste0(address, ": ", year, " - ", until)
  )
locations_updated = bind_rows(
  locations_salamanca,
  locations_minimal
) |>
  arrange(year) |>
  transmute(
    Location = address,
    Years
  )
locations_updated |>
  knitr::kable()
readr::write_csv(locations_updated, "locations_updated.csv")
```

```{r}
if (!file.exists("locations.geojson")) {
  locations = read_csv("locations_updated.csv")
  locations_lonlat = sapply(locations$Location, stplanr::geo_code)
  # locations_lonlat_df = data.frame(
  #   lon = runif(nrow(locations), -2, 2),
  #   lat = runif(nrow(locations), 40, 55)
  # )
  locations_lonlat_df = locations_lonlat |>
    t() |>
    as.data.frame() |>
    setNames(c("lon", "lat"))
  locations_sfc = sf::st_as_sf(locations_lonlat_df, coords = c("lon", "lat"), crs = 4326)
  locations_sf = sf::st_sf(
    locations,
    geometry = locations_sfc$geometry
  )
  sf::write_sf(locations_sf, "locations.geojson", delete_dsn = TRUE)
} else {
  locations_sf = read_sf("locations.geojson")
}
```

```{r}
#| label: fig-locations-1
#| fig.cap: "Places I have lived for 1+ years"
tm_shape(locations_sf) + 
  tm_dots("lightblue", size = 1) +
  tm_text("Years")
```

# Past. Herefordshire (1985-2004) {.center background-image="images/paste-15.png" background-opacity="0.5"}

Photo taken: 1932 in Norton Canon, Herefordshire

::: notes
-   Hard to know how far to go back
-   Where I was born seems a good place to start, in Norton Canon
-   It wasn't this house, but was in the same location, in a photo taken in 1932. I have no idea how my dad got this photo, but it was a great find!
-   My mum and dad moved to Herefordshire in 1979
-   I was born in 1985, six years after they moved but the house still wasn't 100% finished, I may have inherited some of my dad's time optimism
-   Huge thanks to them for physically building a strong foundation for me
:::

## Where I grew up

Photo: 2025 from Google Street View

![](images/paste-16.png)

## Where I'm from

```{r}
#| label: fig-locations-hereford
#| fig.cap: "Places where I spent a lot of time in Herefordshire"
if (!file.exists("locations_herefordshire.geojson")) {
Location = c(
  "HR4 7BP",
  "Weobley school, Herefordshire",
  "Hereford",
  "Leominster, Herefordshire",
  "Hay on Wye"
  )
locations_lonlat = sapply(Location, stplanr::geo_code)
locations_lonlat_df = locations_lonlat |>
  t() |>
  as.data.frame() |>
  setNames(c("lon", "lat"))
locations_herefordshire = sf::st_as_sf(locations_lonlat_df, coords = c("lon", "lat"), crs = 4326)
Location[1] = "Pool Cottage"
locations_herefordshire$Location = Location
sf::write_sf(locations_herefordshire, "locations_herefordshire.geojson", delete_dsn = TRUE)
} else {
  locations_herefordshire = read_sf("locations_herefordshire.geojson")
}
qtm(locations_herefordshire) + 
  tm_dots("lightblue", size = 1) +
  tm_text("Location")

```

::: notes
-   Norton Canon is a village with around 200 people
-   It had a school, shop, pub church, post office and garage within walking distance when I was growing up but now only has two of those
-   It's remote, roughly equidistant from Hereford, Leominster and Hay on Wye
-   Although Hay on Wye is physically closer, it always felt further away because we rarely went that way, but you could feel the Welsh influence in the Black Mountains
-   I went to school in Weobley, which is a village with a primary school and secondary school, and a few shops, but not much else
-   I went to Hereford Sixth Form College in what felt like a big city at the time, but is less than a 10th the size of Leeds with around 50,000 people
-   I worked in the leisure centre in Leominster and played lots of sport
:::

```{=html}
<!-- ## Pool Cottage in the garden

![](images/paste-37.png) -->
```

```{=html}
<!-- ## Weobley primary school

![](images/paste-38.png) -->
```

<!-- Photo of Weobley High School / IMD -->

```{=html}
<!-- ::: notes

This is a photo of the football team in Weobley primary school

::: -->
```

# Bristol (2004-2008) {.center background-image="images/paste-2.jpeg" background-opacity="0.5"}

Photo taken: April 2025 at the GISRUK conference in Bristol

With a year in Salamanca

```{=html}
<!-- ![](images/paste-39.png)

## Bristol 2025

![](images/paste-40.png) -->
```

# Salamanca (2006-2007) {.center background-image="images/paste-3.jpeg" background-opacity="0.5"}

Photo taken: June 2007 from my flat at the time in Salamanca

```{=html}
<!-- ## Salamanca on Erasmus exchange (2006-2007)

![](images/paste-55.png) -->
```

# York (2008-2009) {.center background-image="images/paste-4.jpeg" background-opacity="0.5"}

------------------------------------------------------------------------

-   Scholarship to study Environmental Science and Management

```{bash}
#| eval: false
# Install imagemagick on ubuntu
sudo apt install imagemagick
# Crop the top 15% off images/paste-51.png
mogrify -gravity North -crop 100%x85%+0+0 images/paste-51.png
```

::::: columns
::: {.column width="50%"}
![](images/paste-52.png)

Influential book "SEWTHA", freely available at [withouthotair.com](https://www.withouthotair.com/) [@mackay2009]
:::

::: {.column width="50%"}
![](images/paste-54.png)

Blog post in [The Oil Drum](http://theoildrum.com/node/5976)
:::
:::::

# Sheffield {.center background-image="images/paste-1.jpeg" background-opacity="0.5" background-size="70%"}

```{=html}
<!-- ## a

![](images/paste-43.png) -->
```

<!-- ![](images/paste-41.png) -->

## Engineers Without Borders (EWB)

![](images/paste-47.png)

# Wind turbine group

![](images/paste-45.png)

## Finished wind turbine

![](images/paste-46.png)

## Interest in sustainable transport

![Cargo bike and bike trailers in action, June 2010](images/paste-49.png)

![](images/paste-48.png)

## My thesis

Source: https://etheses.whiterose.ac.uk/id/eprint/5027/

![](images/paste-61.png)

<!-- ![](images/paste-42.png) -->

## Spatial microsimulation

![](images/paste-56.png)

```{=html}
<!-- ![](images/paste-57.png)

![](images/paste-58.png)

![](images/paste-59.png)

![](images/paste-60.png) -->
```

# Past II. Leeds 2013-... {.center background-image="images/paste-5.jpeg" background-opacity="0.5" background-size="70%"}

Photo taken: February 2021, Sugarwell Hill, Leeds

------------------------------------------------------------------------

::: {style="font-size: 0.8em;"}
**First proper job** (üôèMark Birkin) and first Leeds-based paper [@lovelace2014]
:::

::::: columns
::: {.column width="40%"}
![](images/paste-62.png)
:::

::: {.column width="40%"}
![](images/paste-63.png)
:::
:::::

::: notes
This paper was about using new sources of data to inform models of human movement.

It was fascinating from an academic and methods perspective, and was ideal for strengthening my data science and programming skills.

But it lacked meaning for me: the dataset was on visits to museums in Leeds.
That is interesting, but not exactly life changing, or the kind of "save the world" stuff I wanted to do.

Incidentally the paper was never actually published, we submitted to a journal but never heard back.

I posted it on the arXiv and it got around 20 citations, which is not bad for a paper that was never published.
Rather than focus on publishing it elsewhere, I moved on to other things.

Morale of the story: don't give up!
:::

## Side projects: Cycling uptake work for CyclingUK

![](images/paste-69.png)

Source: CyclingUK (formerly CTC) response to government's [Cycling Delivery Plan](https://www.gov.uk/government/consultations/cycling-delivery-plan-informal-consultation) consultation, available [online at cyclinguk.org](https://www.cyclinguk.org/sites/default/files/document/migrated/news/1411_ctcsj_cdp_response_con_finalca.pdf).

<!-- TODO: add links to this https://www.gov.uk/government/consultations/cycling-delivery-plan-informal-consultation -->

## Work commissioned by CyclingUK (previously CTC)

![](images/paste-66.png)

[Work](https://github.com/Robinlovelace/energy-cycling) on the economic benefits of cycling nationwide with James Woodcock and Fiona Crawford [@crawford2015]

## Propensity to Cycle Tool ([www.pct.bike](https://www.pct.bike/))

::::: columns
::: {.column width="50%"}
![](images/paste-64.png) ![](images/paste-65.png) Source: article in practitioner magazine [@lovelace2016].
:::

::: {.column width="50%"}
![](images/paste-68.png)

First Propensity to Cycle Tool paper published in an academic journal [@lovelace2017]
:::
:::::

## From research to web tool

![](images/paste-70.png)

## Research impact

![](images/paste-71.png){width="70%"}

Source: leeds.ac.uk front page, 2017-03-17

## 4\* Research Excellence Framework (REF) case study

![](images/paste-72.png)

Source: [results2021.ref.ac.uk](https://results2021.ref.ac.uk/impact/847d1191-7f25-46ba-a399-b481125edc8f?page=1) [@lovelace2023]

## Internship in No. 10 Downing Street

::::: columns
::: {.column width="30%"}

Fellowship in collaboration with 10 Downing Street, ONS, Data Science Campus, ADRUK, ESRC from November 2021 until April 2023

Source: [Press Release "No.10 Data Science Fellowship"](https://environment.leeds.ac.uk/research-project/1/faculty-of-environment/1757/no-10-data-science-fellowship)

:::

::: {.column width="70%"}
<!-- ![](images/paste-76.png) -->

![](images/paste-11.jpeg)

Source: ‚ÄúPackaging Code and Data for Reproducible Research: A Case Study of Journey Time Statistics.‚Äù Environment and Planning B @botta2024.
:::
:::::

## Active Travel England

<!-- {background-image="images/paste-9.jpeg" background-opacity="0.5" background-size="70%"} -->

::::: columns
::: {.column width="65%"}
<img src="images/paste-9.jpeg" alt="Department for Transport&apos;s Data Science for Transport conference" style="width: 80%; opacity: 0.8;"/>
:::

::: {.column width="35%"}
2 year contract in the Civil Service from January 2023

My roles:

-   Recruit the team
-   Lead Data Scientist
-   Projects: plan.activetravelengland.gov.uk (formerly ATIP), SchoolRoutes
:::
:::::

Source: photo taken May 2023 at the Department for Transport's Data Science for Transport conference

----

**Active Travel England - Alan Turing Institute grant**

<!-- ::::: columns
::: {.column width="50%"}
![](images/paste-74.png)
:::

::: {.column width="50%"}
![](images/paste-73.png) -->

![](images/paste-10.jpeg){width="70%"}
<!-- :::
::::: -->

Photo credit: [Danny Williams](https://www.linkedin.com/feed/update/urn:li:activity:7041103075536707584/) 

# Present {.center background-image="images/paste-67.png" background-opacity="0.5" background-size="70%"}

::: notes
And as shown in the photo, they are also transport planning enthusiasts, undertaking action-based research here to find out how old babies need to be before they can go in a bike trailer!
:::

------------------------------------------------------------------------

::::: columns
::: {.column width="60%"}
![](images/paste-7.jpeg)
:::

::: {.column width="40%"}
### Massive thanks to

### Katy

### Kit

### Rosa
:::
:::::

::: notes
-   A big part of my life now is my family, and I want to say thank you to my wife Katy and my kids Kit (3 years old) and Rosa (six months old) for their support and love. I couldn't do this without them. I have much better work-life balance now than I did when I was a PhD student
-   Family is the foundation on which many good things build.
:::

## My current role

::::::: columns
:::: {.column width="40%"}
::: incremental
-   Professor of Transport Data Science
-   Work with government
-   Focus on impact
-   R package developer and data scientist
-   New methods for more reproducible, data-driven and participatory transport planning
:::
::::

:::: {.column width="60%"}
::: {layout="[[1,2], [1]]"}
![](https://r.geocompx.org/images/cover.png)

![](https://github.com/npct/pct-team/blob/master/figures/front-page-leeds-pct-demo.png?raw=true)

![](images/paste-17.png)
:::
::::
:::::::

## What is Transport Data Science?

## (I-)Reproducibility

Reproducibility is a continuous variable [@peng2011]

![](images/paste-18.png)

# Reproducible research

## Why make your research (more) reproducible?

:::::: columns
::: {.column width="80%"}
![](images/paste-36.png)

Source: @raff2023
:::

:::: {.column width="20%"}
::: incremental
-   Scientific rigour
-   Benefits to your future self
-   Benefits to others
-   Huge increase in potential for impact
:::
::::
::::::

## Why *not* make your research reproducible?

::: {.column width="20%"}
![](images/paste-28.png)
:::

::: column
-   Time

-   Know-how

-   Lack of permission

-   Software is not open

-   Data is not open access

-   Someone might use it in unethical ways

-   Someone might "steal" the work
:::

## Example of fully reproducible research

![](images/paste-23.png)

@lovelace2022

## Reproducibility and generalisability

![](images/paste-24.png)

Illustration of the ClockBoard zoning system used to visualize a geographically dependendent phenomena: air quality, measured in mass of PM10 particles, measured in micrograms per cubic meter, from the London Atmospheric Emissions Inventory (LAEI).
The facets show the data in spatial grid available from the LAEI, facet Am and aggregated to London boroughs B, to ClockBoard zones covering all the input data shown in C, and ClockBoard zones clipped by the administrative boundary of Greater London in D.

## Application: road traffic casualties

![](images/paste-26.png)

![](images/paste-27.png)

## International comparisons

::::: columns
::: {.column width="70%"}
![](images/paste-25.png)
:::

::: {.column width="30%"}
**Premise**: A key reason for reproducibility is *generalisability*.
:::
:::::

# Open source software and open access tools

## Case study: mobile telephone data in Spain

![](images/paste-1.png)

## Don't reinvent the wheel

::::: columns
::: {.column width="40%"}
### Before

```{r}
#| eval: false
#| echo: true
options(timeout = 600) # 10 minutes
u1 = "https://movilidad-opendata.mitma.es/estudios_basicos/por-distritos/viajes/ficheros-diarios/2024-03/20240301_Viajes_distritos.csv.gz"
f1 = basename(u1)
if (!file.exists(f1)) {
  download.file(u1, f1)
}
drv = duckdb::duckdb("daily.duckdb")
con = DBI::dbConnect(drv)
od1 = duckdb::tbl_file(con, f1)
```

Credit: [Egor Kotov](https://github.com/Robinlovelace/spanishoddata/blob/main/draft-code/001-convert-to-clean-data.r)
:::

::: {.column width="60%"}
```{r}
#| eval: false
#| echo: true
remotes::install_github("Robinlovelace/spanishoddata")
od_multi_list = get_od(date_regex = "2024030[1-7]")
# ...
n_per_hour |>
  ggplot(aes(x = Time, y = Trips)) +
  geom_line(aes(colour = Day)) +
  labs(title = "Number of trips per hour over 7 days")
```

![](images/paste-2.png)
:::
:::::

## Building/linking-up-with communities

The package has been onboarded to rOpenSpain public benefit data science community (see [ropenspain.github.io](https://ropenspain.github.io/spanishoddata/))

![](images/paste-13.png)

## Cross-language collaboration

![](images/paste-7.png)

Source: <https://github.com/dabreegster/odjitter>

## From open source to open access

<!-- ![](images/paste-9.png) -->

::::: columns
::: {.column width="40%"}
"In essence ‚Äòopen access‚Äô goes beyond ‚Äòopen source‚Äô in that users are not only given the option of viewing (potentially indecipherable) source code, but are encouraged to do so, with measures taken in the software itself, and the community that builds it, to make it more user-friendly.""

Source: [@lovelace2020]
:::

::: {.column width="60%"}
![](images/paste-10.png)
:::
:::::

## References

::: {#refs}
:::